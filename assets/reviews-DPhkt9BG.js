import{s as r}from"./dashboards-BzIxZDf7.js";import"./vendor-BLPh2XG4.js";import"./ui-Dc2VBgM7.js";import"./supabase-wzm6nDUs.js";async function e(e){const t=async e=>await r.from("reviews").insert([e]).select().single();try{const{error:r,data:s}=await t(e);if(r){const s=r.message||r.msg||JSON.stringify(r),o=s.match(/Could not find the '([a-zA-Z0-9_]+)' column/);if(o){const r=o[1],{[r]:s,...n}=e;return await t(n)}if(s.toLowerCase().includes("permission")||s.toLowerCase().includes("policy")){const{user_id:r,salon_id:s,...o}=e;return await t(o)}return{error:r}}return{error:null,data:s}}catch(s){const t=s&&(s.message||s.msg||JSON.stringify(s))||"",a=t.match(/Could not find the '([a-zA-Z0-9_]+)' column/);if(a){const t=a[1],{[t]:s,...n}=e;try{const{error:e,data:t}=await r.from("reviews").insert([n]).select().single();return{error:e,data:t}}catch(o){return{error:o}}}if(t.toLowerCase().includes("permission")||t.toLowerCase().includes("policy")){const{user_id:t,salon_id:s,...o}=e;try{const{error:e,data:t}=await r.from("reviews").insert([o]).select().single();return{error:e,data:t}}catch(n){return{error:n}}}return{error:s}}}export{e as insertReviewSafe};
